<!-- <!DOCTYPE html>
<meta charset="utf-8">

<head>
<link href="https://fonts.googleapis.com/css?family=Raleway:400,800,700" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
<link rel="stylesheet" href="styles/bootstrap.min.css">
<link rel="stylesheet" href="styles/style_lumcon.css">
<link rel="stylesheet" href="styles/chosen.min.css"></script>  
<script src="libraries/jquery-3.1.1.min.js" type="text/javascript" charset="utf-8"></script>
<script src="libraries/chosen.jquery.min.js"></script>
<script src="libraries/d3.v4.min.js" type="text/javascript" charset="utf-8"></script>
<script src="javascript/ratios.js" type="text/javascript" charset="utf-8"></script>
<script src="libraries/d3-tip.js"></script>
<script src="libraries/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>


<script>

d3.csv("data/russian_attacks.csv", function (error,data){
      if(error) throw error;

      console.log(data);
})

</script>

</body>
</html> -->

<!-- <!DOCTYPE html>
<meta charset="utf-8">

<head>
<link href="https://fonts.googleapis.com/css?family=Raleway:400,800,700" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
<link rel="stylesheet" href="styles/bootstrap.min.css">
<link rel="stylesheet" href="styles/style_lumcon.css">
<link rel="stylesheet" href="styles/chosen.min.css"></script>  
<script src="libraries/jquery-3.1.1.min.js" type="text/javascript" charset="utf-8"></script>
<script src="libraries/chosen.jquery.min.js"></script>
<script src="libraries/d3.v4.min.js" type="text/javascript" charset="utf-8"></script>
<script src="javascript/ratios.js" type="text/javascript" charset="utf-8"></script>
<script src="libraries/d3-tip.js"></script>
<script src="libraries/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>


<script>

d3.csv("data/russian_attacks.csv", function (error,data){
      if(error) throw error;

      console.log(data);
})

</script>

</body>
</html> -->



<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='utf-8'>
  <meta content='width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0' name='viewport'>

  <title>dc.js Experiment</title>

  <script src='libraries/d3.v3.min.js' type='text/javascript'></script>
  <script src='libraries/crossfilter.min.js' type='text/javascript'></script>
  <script src='libraries/dc.min.js' type='text/javascript'></script>
  <script src='libraries/jquery.v2.min.js' type='text/javascript'></script>
  <script src='libraries/bootstrap.min.js' type='text/javascript'></script>

  <link href='styles/bootstrap.min.css' rel='stylesheet' type='text/css'>
  <link href='styles/dc.css' rel='stylesheet' type='text/css'>

  <style type="text/css"></style>
</head>

<body>

<div class='container' id='main-container' style='margin-left:3% !important'>
<div class='content'>
<div class='container' style='font: 12px sans-serif;'>


  <div class='row'>
	<div class='pie-graph span12'>
      <table class='table table-hover' id='dc-data-table'>
        <thead>
          <tr class='header'>
            <th>DTG</th>
            <th>Lat</th>
            <th>Long</th>
            <th>Location</th>
            <th>Violation</th>
          </tr>
        </thead>
      </table>
	</div>
  </div>

<H5>Generated with 
  <a href="http://nickqizhu.github.io/dc.js/">dc.js</a>,
  <a href="http://square.github.io/crossfilter/">crossfilter</a>, 
  <a href="http://d3js.org/">d3.js</a> and 
  <a href="http://twitter.github.io/bootstrap/">bootstrap</a>.
</H5>
<p>Earthquake data via <a href="http://geonet.org.nz">Geonet</a>.</p>

</div>
</div>
</div>
  
<script>
  
/**********************************
* Step0: Load data from json file *
**********************************/

d3.csv("data/russian_attacks.csv", function (data) {
	console.log("SYRIA: ",data);

	neighborhoodStrat = {}
	cityStrat = {}

	for (let entry of data) {
		var loc = (entry.location).split(" ");

		if(neighborhoodStrat[entry.location]) {
			neighborhoodStrat[entry.location]++;
		} else {
			neighborhoodStrat[entry.location] = 1;
		}

		if(cityStrat[loc[0]]) {
			cityStrat[loc[0]]++;
		} else {
			cityStrat[loc[0]] = 1;
		}

	}

	// format data - 2016-09-10 21:24:00+00:00
	var dtgFormat = d3.time.format("%Y-%m-%d %H:%M:%S")
	data.forEach(function(d){
		d.dtg = dtgFormat.parse(d.recording_date.substr(0,d.recording_date.length));
		//console.log(d.dtg);
		d.latitude = +d.location_latitude;
		d.longitude = +d.location_longitude;
		d.loc = +d.location;
		d.violation = +d.type_of_violation;
	})

	// var dateChart = dc.lineChart("#dc-date-chart");
	// var violationChart = dc.barChart("#dc-violation-chart")
	var dataTable = dc.dataTable("#dc-data-table");

	/****************************************
	* 	Run the data through crossfilter    *
	****************************************/

  var facts = crossfilter(data);  // Gets our 'facts' into crossfilter

  console.log(facts);

  	/******************************************************
	* Step4: Create the Dimensions                        *
	******************************************************/


  // For datatable
  var timeDimension = facts.dimension(function (d) {
  	//console.log(d.dtg);
    return d.dtg;
  }); // group or filter by time

  //console.log(facts);

/***************************************
* 	Step5: Create the Visualisations   *
***************************************/

  // Table of earthquake data
  dataTable.width(960).height(800)
    .dimension(timeDimension)
	.group(function(d) { return "List of all human rights violations in Syria" })
	.size(data.length-1)
    .columns([
      function(d) { console.log(d.dtg); return d.dtg; },
      function(d) { console.log(d.latitude); return d.latitude; },
      function(d) { console.log(d.longitude); return d.longitude; },
      function(d) { console.log("LOC: ",d.loc); return d.loc; },
      function(d) { console.log(d.violation); return d.violation; }
    ])
    .sortBy(function(d){ return d.dtg; })
    .order(d3.ascending);

/****************************
* Step6: Render the Charts  *
****************************/

 
 dc.renderAll();

});
  
</script>
    
</body>
</html>

